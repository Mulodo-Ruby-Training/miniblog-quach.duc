<!DOCTYPE html>
<html>
<head>
  <%= favicon_link_tag 'favicon.ico' %>
  <title>Mini Blog <%= current_page_path %> </title>
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <!-- Add ckeditor -->
  <%= javascript_include_tag "//cdn.ckeditor.com/4.4.7/standard/ckeditor.js" %>
  <%= csrf_meta_tags %>
</head>
<body >
  <!-- Navigation -->
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only" title="Back to home" ><i class="fa fa-home fa-lg" title="Home%>"></i>&nbsp;Mini blog</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
              </button>
            <a class="navbar-brand" href="/" title="Back to home"><i class="fa fa-home fa-lg" title="Home%>"></i>&nbsp;Mini blog</a>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right pull-right">
                  <% if ["/posts","/list_users"].include?(current_path("controller")) %>
                    <form class="navbar-form navbar-left" role="search" method="get">
                      <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search" name="search_key">
                      </div>
                      <button type="submit" class="btn btn-default">Search</button>
                    </form>
                  <% end %>
                  <li>
                      <a href="/posts">Posts</a>
                  </li>
                  <li>
                      <a href="/list_users">Users</a>
                  </li>
                  <% if current_user %>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" id="profile" data-toggle="dropdown" role="button" aria-expanded="false">
                           <% if current_user.avatar_path %>
                              <div style="width: 30px; height:30px; border:solid; border-width: 1px;">
                                <%= image_tag "/upload/"+current_user.avatar_path,:style => " width: 100%; height: 100%; object-fit: fill;", :title => current_user.username %>
                              </div>
                            <% else %>
                              <div>
                                <%= current_user.username.upcase %><span class="caret"></span>
                              </div>
                            <% end %>
                        </a>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="profile">
                          <li><%= link_to "Profile", "/users/"+current_user[:id].to_s %></li>
                          <li><%= link_to 'My posts',"/posts?user_id="+current_user[:id].to_s %></li>
                          <li><%= link_to "Log out", log_out_path %></li>
                        </ul>
                      </li>
                  <% else %>
                    <li>
                      <%= link_to "Log in", log_in_path %>
                    </li>
                    <li>
                      <%= link_to "Sign up", sign_up_path %>
                    </li>
                  <% end %>
              </ul>
          </div>
          <!-- /.navbar-collapse -->
      </div>
      <!-- /.container -->
  </nav>
  <%= yield %>
</body>
</html>
